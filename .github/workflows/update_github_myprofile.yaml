name: Update github myprofile

on:
  page_build:
  workflow_dispatch:   # 手动触发，方便你随时运行

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Install Reqs
        run: |
          sudo apt-get update -y
          sudo apt-get install -y python3-setuptools

      - name: Run
        env:
          REMOTE_REPO: "https://SuperBearcafedo:${{ secrets.TOKEN }}@github.com/SuperBearcafedo/SuperBearcafedo.git"
        run: |
          # 运行更新脚本
          cd ./github_myprofile_updater
          python3 update.py

          # 回到仓库根目录做提交
          cd "${GITHUB_WORKSPACE}"

          git config --local user.name "SuperBearcafedo"
          git config --local user.email "sjiexiongmore@outlook.com"

          git add README.md
          git add images || true
          git commit -m "update my description automatically" || echo "nothing to commit"

          # 推送到目标仓库 main 分支
          git push "${REMOTE_REPO}" HEAD:main --force
